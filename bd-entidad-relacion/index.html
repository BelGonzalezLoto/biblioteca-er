<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagrama ER - Sistema de Biblioteca</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.2em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .controls {
            text-align: center;
            margin-bottom: 20px;
        }

        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            margin: 0 5px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn.active {
            background: #e74c3c;
        }

        .diagram-container {
            width: 100%;
            height: 700px;
            border: 2px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
            background: #f9f9f9;
            margin-bottom: 30px;
        }

        .info-panel {
            background: #ecf0f1;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
            border-left: 5px solid #3498db;
        }

        .info-panel.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        .entity-rect { fill: #4a90e2; stroke: #357abd; stroke-width: 2; }
        .entity-text { fill: white; font-family: Arial, sans-serif; font-weight: bold; }
        .attribute-text { fill: white; font-family: Arial, sans-serif; font-size: 11px; }
        .pk-text { fill: #ffeb3b; font-weight: bold; text-decoration: underline; }
        
        .relation-diamond { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
        .relation-text { fill: white; font-family: Arial, sans-serif; font-weight: bold; font-size: 11px; text-anchor: middle; }
        
        .connection-line { stroke: #333; stroke-width: 2; }
        .cardinality-text { fill: #2c3e50; font-family: Arial, sans-serif; font-weight: bold; font-size: 14px; }
        
        .highlighted { filter: drop-shadow(0 0 10px #e74c3c); }
        .entity-rect.highlighted { fill: #e74c3c; }
        .relation-diamond.highlighted { fill: #e74c3c; }

        svg { width: 100%; height: 100%; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Diagrama Entidad-Relaci√≥n - Trabajo Pr√°ctico N¬∞2</h1>
        <p class="subtitle">Sistema de Biblioteca </p>

        <div class="legend">
            <div class="legend-item">
                <div style="width: 20px; height: 20px; background: #4a90e2; margin-right: 10px; border-radius: 3px;"></div>
                <span><strong>Entidades:</strong> Objetos del mundo real</span>
            </div>
            <div class="legend-item">
                <div style="width: 20px; height: 20px; background: #f39c12; margin-right: 10px; transform: rotate(45deg);"></div>
                <span><strong>Relaciones:</strong> Asociaciones entre entidades</span>
            </div>
            <div class="legend-item">
                <div style="width: 20px; height: 20px; background: #2ecc71; margin-right: 10px; border-radius: 50%;"></div>
                <span><strong>Cardinalidades:</strong> Restricciones num√©ricas</span>
            </div>
            <div class="legend-item">
                <div style="width: 20px; height: 20px; background: #ffeb3b; margin-right: 10px; border-radius: 3px;"></div>
                <span><strong>PK/FK:</strong> Claves primarias y for√°neas</span>
            </div>
        </div>

        <div class="controls">
            <button class="btn" onclick="highlightElement('autor')">AUTOR</button>
            <button class="btn" onclick="highlightElement('libro')">LIBRO</button>
            <button class="btn" onclick="highlightElement('usuario')">USUARIO</button>
            <button class="btn" onclick="highlightElement('prestamo')">PR√âSTAMO</button>
            <button class="btn" onclick="highlightElement('escribe')">ESCRIBE</button>
            <button class="btn" onclick="highlightElement('realiza')">REALIZA</button>
            <button class="btn" onclick="highlightElement('incluye')">INCLUYE</button>
            <button class="btn" onclick="showNotations()">Notaciones</button>
            <button class="btn" onclick="resetView()">Reiniciar</button>
        </div>

        <div class="diagram-container">
            <svg viewBox="0 0 1200 600" xmlns="http://www.w3.org/2000/svg">
                <!-- Definiciones -->
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
                            refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
                    </marker>
                </defs>

                <!-- ENTIDAD AUTOR -->
                <g id="autor-group" onclick="showInfo('autor')" style="cursor: pointer;">
                    <rect id="autor-rect" class="entity-rect" x="50" y="80" width="180" height="120" rx="8"/>
                    <text class="entity-text" x="140" y="105" text-anchor="middle" font-size="16">AUTOR</text>
                    <line x1="60" y1="115" x2="220" y2="115" stroke="white" stroke-width="1"/>
                    <text class="attribute-text pk-text" x="65" y="130">id_autor (PK)</text>
                    <text class="attribute-text" x="65" y="145">nombre</text>
                    <text class="attribute-text" x="65" y="160">apellido</text>
                    <text class="attribute-text" x="65" y="175">nacionalidad</text>
                    <text class="attribute-text" x="65" y="190">fecha_nacimiento</text>
                </g>

                <!-- ENTIDAD LIBRO -->
                <g id="libro-group" onclick="showInfo('libro')" style="cursor: pointer;">
                    <rect id="libro-rect" class="entity-rect" x="950" y="80" width="180" height="120" rx="8"/>
                    <text class="entity-text" x="1040" y="105" text-anchor="middle" font-size="16">LIBRO</text>
                    <line x1="960" y1="115" x2="1120" y2="115" stroke="white" stroke-width="1"/>
                    <text class="attribute-text pk-text" x="965" y="130">ISBN (PK)</text>
                    <text class="attribute-text" x="965" y="145">titulo</text>
                    <text class="attribute-text" x="965" y="160">a√±o_publicacion</text>
                    <text class="attribute-text" x="965" y="175">editorial</text>
                    <text class="attribute-text" x="965" y="190">categoria</text>
                </g>

                <!-- ENTIDAD USUARIO -->
                <g id="usuario-group" onclick="showInfo('usuario')" style="cursor: pointer;">
                    <rect id="usuario-rect" class="entity-rect" x="50" y="400" width="180" height="120" rx="8"/>
                    <text class="entity-text" x="140" y="425" text-anchor="middle" font-size="16">USUARIO</text>
                    <line x1="60" y1="435" x2="220" y2="435" stroke="white" stroke-width="1"/>
                    <text class="attribute-text pk-text" x="65" y="450">id_usuario (PK)</text>
                    <text class="attribute-text" x="65" y="465">nombre</text>
                    <text class="attribute-text" x="65" y="480">apellido</text>
                    <text class="attribute-text" x="65" y="495">email</text>
                    <text class="attribute-text" x="65" y="510">tipo_usuario</text>
                </g>

                <!-- ENTIDAD PRESTAMO -->
                <g id="prestamo-group" onclick="showInfo('prestamo')" style="cursor: pointer;">
                    <rect id="prestamo-rect" class="entity-rect" x="950" y="400" width="180" height="120" rx="8"/>
                    <text class="entity-text" x="1040" y="425" text-anchor="middle" font-size="16">PR√âSTAMO</text>
                    <line x1="960" y1="435" x2="1120" y2="435" stroke="white" stroke-width="1"/>
                    <text class="attribute-text pk-text" x="965" y="450">id_prestamo (PK)</text>
                    <text class="attribute-text" x="965" y="465">fecha_prestamo</text>
                    <text class="attribute-text" x="965" y="480">fecha_dev_estimada</text>
                    <text class="attribute-text" x="965" y="495">fecha_dev_real</text>
                    <text class="attribute-text" x="965" y="510">estado</text>
                </g>

                <!-- RELACI√ìN ESCRIBE -->
                <g id="escribe-group" onclick="showInfo('escribe')" style="cursor: pointer;">
                    <polygon id="escribe-diamond" class="relation-diamond" 
                             points="600,140 650,170 600,200 550,170"/>
                    <text class="relation-text" x="600" y="175">ESCRIBE</text>
                </g>

                <!-- RELACI√ìN REALIZA -->
                <g id="realiza-group" onclick="showInfo('realiza')" style="cursor: pointer;">
                    <polygon id="realiza-diamond" class="relation-diamond" 
                             points="400,460 450,490 400,520 350,490"/>
                    <text class="relation-text" x="400" y="495">REALIZA</text>
                </g>

                <!-- RELACI√ìN INCLUYE -->
                <g id="incluye-group" onclick="showInfo('incluye')" style="cursor: pointer;">
                    <polygon id="incluye-diamond" class="relation-diamond" 
                             points="800,460 850,490 800,520 750,490"/>
                    <text class="relation-text" x="800" y="495">INCLUYE</text>
                </g>

                <!-- L√çNEAS DE CONEXI√ìN -->
                <!-- AUTOR - ESCRIBE -->
                <line class="connection-line" x1="230" y1="140" x2="550" y2="170"/>
                <!-- ESCRIBE - LIBRO -->
                <line class="connection-line" x1="650" y1="170" x2="950" y2="140"/>
                
                <!-- USUARIO - REALIZA -->
                <line class="connection-line" x1="230" y1="460" x2="350" y2="490"/>
                <!-- REALIZA - PRESTAMO -->
                <line class="connection-line" x1="450" y1="490" x2="950" y2="460"/>
                
                <!-- PRESTAMO - INCLUYE -->
                <line class="connection-line" x1="950" y1="480" x2="850" y2="490"/>
                <!-- INCLUYE - LIBRO -->
                <line class="connection-line" x1="750" y1="490" x2="950" y2="200"/>

                <!-- CARDINALIDADES -->
                <circle cx="280" cy="150" r="15" fill="#2ecc71"/>
                <text class="cardinality-text" x="280" y="157" text-anchor="middle">M</text>
                
                <circle cx="900" cy="150" r="15" fill="#2ecc71"/>
                <text class="cardinality-text" x="900" y="157" text-anchor="middle">N</text>
                
                <circle cx="280" cy="470" r="15" fill="#2ecc71"/>
                <text class="cardinality-text" x="280" y="477" text-anchor="middle">1</text>
                
                <circle cx="500" cy="480" r="15" fill="#2ecc71"/>
                <text class="cardinality-text" x="500" y="487" text-anchor="middle">N</text>
                
                <circle cx="900" cy="490" r="15" fill="#2ecc71"/>
                <text class="cardinality-text" x="900" y="497" text-anchor="middle">N</text>
                
                <circle cx="900" cy="220" r="15" fill="#2ecc71"/>
                <text class="cardinality-text" x="900" y="227" text-anchor="middle">1</text>
            </svg>
        </div>

        <!-- PANELES DE INFORMACI√ìN -->
        <div class="info-panel" id="info-autor">
            <h3>üßë‚Äçüéì ENTIDAD: AUTOR</h3>
            <p><strong>Tipo:</strong> Entidad Fuerte</p>
            <p><strong>Clave Primaria:</strong> id_autor</p>
            <p><strong>Descripci√≥n:</strong> Representa a los escritores de los libros en la biblioteca.</p>
            <p><strong>Relaci√≥n:</strong> Un autor puede ESCRIBIR m√∫ltiples libros (M:N con LIBRO)</p>
        </div>

        <div class="info-panel" id="info-libro">
            <h3>üìö ENTIDAD: LIBRO</h3>
            <p><strong>Tipo:</strong> Entidad Fuerte</p>
            <p><strong>Clave Primaria:</strong> ISBN</p>
            <p><strong>Descripci√≥n:</strong> Representa los libros disponibles en la biblioteca.</p>
            <p><strong>Relaciones:</strong> Puede ser escrito por m√∫ltiples autores (M:N) y puede ser incluido en pr√©stamos (1:N)</p>
        </div>

        <div class="info-panel" id="info-usuario">
            <h3>üë§ ENTIDAD: USUARIO</h3>
            <p><strong>Tipo:</strong> Entidad Fuerte</p>
            <p><strong>Clave Primaria:</strong> id_usuario</p>
            <p><strong>Descripci√≥n:</strong> Representa a los usuarios de la biblioteca (estudiantes, profesores, personal).</p>
            <p><strong>Relaci√≥n:</strong> Un usuario puede REALIZAR m√∫ltiples pr√©stamos (1:N con PR√âSTAMO)</p>
        </div>

        <div class="info-panel" id="info-prestamo">
            <h3>üìã ENTIDAD: PR√âSTAMO</h3>
            <p><strong>Tipo:</strong> Entidad Fuerte</p>
            <p><strong>Clave Primaria:</strong> id_prestamo</p>
            <p><strong>Descripci√≥n:</strong> Representa las transacciones de pr√©stamo de libros.</p>
            <p><strong>Claves For√°neas:</strong> Contiene referencias a USUARIO y LIBRO</p>
        </div>

        <div class="info-panel" id="info-escribe">
            <h3>‚úçÔ∏è RELACI√ìN: ESCRIBE (M:N)</h3>
            <p><strong>Entidades:</strong> AUTOR ‚Üî LIBRO</p>
            <p><strong>Cardinalidad:</strong> Muchos a Muchos</p>
            <p><strong>Notaci√≥n Chen:</strong> ‚óä‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚óä</p>
            <p><strong>Significado:</strong> Un autor puede escribir varios libros, y un libro puede tener varios autores.</p>
            <p><strong>Implementaci√≥n:</strong> Requiere tabla intermedia con claves for√°neas.</p>
        </div>

        <div class="info-panel" id="info-realiza">
            <h3>üìù RELACI√ìN: REALIZA (1:N)</h3>
            <p><strong>Entidades:</strong> USUARIO ‚Üî PR√âSTAMO</p>
            <p><strong>Cardinalidad:</strong> Uno a Muchos</p>
            <p><strong>Notaci√≥n Chen:</strong> ‚ñ°‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚óä</p>
            <p><strong>Significado:</strong> Un usuario puede realizar m√∫ltiples pr√©stamos, pero cada pr√©stamo pertenece a un solo usuario.</p>
        </div>

        <div class="info-panel" id="info-incluye">
            <h3>üìñ RELACI√ìN: INCLUYE (N:1)</h3>
            <p><strong>Entidades:</strong> PR√âSTAMO ‚Üî LIBRO</p>
            <p><strong>Cardinalidad:</strong> Muchos a Uno</p>
            <p><strong>Notaci√≥n Chen:</strong> ‚óä‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚ñ°</p>
            <p><strong>Significado:</strong> M√∫ltiples pr√©stamos pueden incluir el mismo libro (en diferentes momentos), pero cada pr√©stamo incluye un solo libro.</p>
        </div>

        <div class="info-panel" id="info-notaciones">
            <h3>üìê NOTACIONES DEL MODELO E-R</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div>
                    <h4>üî∑ Notaci√≥n Chen (Cl√°sica):</h4>
                    <ul>
                        <li><strong>Rect√°ngulos:</strong> Entidades</li>
                        <li><strong>Rombos:</strong> Relaciones</li>
                        <li><strong>√ìvalos:</strong> Atributos</li>
                        <li><strong>L√≠neas:</strong> Conexiones</li>
                        <li><strong>N√∫meros:</strong> Cardinalidades (1, N, M)</li>
                    </ul>
                </div>
                <div>
                    <h4>ü¶∂ Notaci√≥n Crow's Foot (Moderna):</h4>
                    <ul>
                        <li><strong>||</strong> = Uno</li>
                        <li><strong>}o</strong> = Muchos</li>
                        <li><strong>o</strong> = Cero (opcional)</li>
                        <li><strong>|</strong> = Uno exacto</li>
                        <li><strong>M√°s visual y legible</strong></li>
                    </ul>
                </div>
            </div>
            <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 5px;">
                <strong>üí° En este diagrama:</strong> Usamos la notaci√≥n Chen con rect√°ngulos para entidades, 
                rombos para relaciones, y c√≠rculos numerados para cardinalidades.
            </div>
        </div>
    </div>

    <script>
        let activeButton = null;

        function highlightElement(elementId) {
            resetView();
            
            // Highlight the element
            const element = document.getElementById(elementId + '-rect') || 
                           document.getElementById(elementId + '-diamond');
            if (element) {
                element.classList.add('highlighted');
            }
            
            // Highlight the group
            const group = document.getElementById(elementId + '-group');
            if (group) {
                group.style.filter = 'drop-shadow(0 0 10px #e74c3c)';
            }
            
            // Show info panel
            showInfo(elementId);
            
            // Highlight button
            event.target.classList.add('active');
            activeButton = event.target;
        }

        function showInfo(elementId) {
            // Hide all panels
            document.querySelectorAll('.info-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // Show specific panel
            const panel = document.getElementById('info-' + elementId);
            if (panel) {
                panel.classList.add('active');
            }
        }

        function showNotations() {
            resetView();
            showInfo('notaciones');
            event.target.classList.add('active');
            activeButton = event.target;
        }

        function resetView() {
            // Remove all highlights
            document.querySelectorAll('.highlighted').forEach(el => {
                el.classList.remove('highlighted');
            });
            
            // Remove group filters
            document.querySelectorAll('g[id$="-group"]').forEach(group => {
                group.style.filter = '';
            });
            
            // Hide all panels
            document.querySelectorAll('.info-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // Reset buttons
            document.querySelectorAll('.btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            activeButton = null;
        }

        // Add hover effects
        document.querySelectorAll('g[id$="-group"]').forEach(group => {
            group.addEventListener('mouseenter', function() {
                if (!this.style.filter.includes('drop-shadow')) {
                    this.style.filter = 'drop-shadow(0 0 5px rgba(0,0,0,0.3))';
                }
            });
            
            group.addEventListener('mouseleave', function() {
                if (!this.style.filter.includes('#e74c3c')) {
                    this.style.filter = '';
                }
            });
        });
    </script>
</body>
</html>